<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="0x00 前言最近这个东西实在太火了，而且log4j 和最近的Spring Cloud Gateway 都说是利用codeql来挖掘的，好不好用先用了再说。所以学习一下这个东西   　  0x01 CodeQL是什么　　在我接触这个东西之前，我一直以为这是一个代码审计的工具，类似于Fortify rips 这种东西？　但其实并不是，理解大大错了。。。 还记得记得SQL的全称吗？ -&gt; S">
<meta property="og:type" content="article">
<meta property="og:title" content="Codeql 环境手模手搭建和简单使用">
<meta property="og:url" content="https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/index.html">
<meta property="og:site_name" content="Zeo 安全实验室">
<meta property="og:description" content="0x00 前言最近这个东西实在太火了，而且log4j 和最近的Spring Cloud Gateway 都说是利用codeql来挖掘的，好不好用先用了再说。所以学习一下这个东西   　  0x01 CodeQL是什么　　在我接触这个东西之前，我一直以为这是一个代码审计的工具，类似于Fortify rips 这种东西？　但其实并不是，理解大大错了。。。 还记得记得SQL的全称吗？ -&gt; S">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/6a3c5018d5d0d0db8e4f98dcdca28a2b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/1e197eb521572e3f8c5127107423f3a2.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/a2cb467ec36e31755ce60c6ea7d6bbc8.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/6a3c5018d5d0d0db8e4f98dcdca28a2b.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/6592caf3f2edce99827af28ea26d87c7.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/426fefbba4e3f578100b4c814db923e3.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/80218c8e03b9e69baef9e37553bf9faf.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/1b663484abb11ad4a00eaf9e60d6cf86.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/87b24445faaf162524b17454cefb235f.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/0c7a8368eba51c627e4118781cda3bab.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/738e5fe7a38bfc958543ddbe64af0c88.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/6d797139186e93960c732702e8e527e0.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/b4ac3fe75d4adfda68b9c3ebe8614e7a.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/img_convert/23796c41f92e639d123a40bdbfbeaa4f.png">
<meta property="article:published_time" content="2022-03-14T04:26:04.000Z">
<meta property="article:modified_time" content="2022-10-12T16:32:06.971Z">
<meta property="article:author" content="Zeo">
<meta property="article:tag" content="vscode web安全 代码审计 安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/img_convert/6a3c5018d5d0d0db8e4f98dcdca28a2b.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Codeql 环境手模手搭建和简单使用</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/true" title="Zeo 安全实验室" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/categories">分类</a></li>
         
          <li><a href="/projects_url">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2022/03/27/%E8%BD%AC%E8%BD%BD%EF%BC%9AGitee%20%E5%9B%BE%E5%BA%8A%20%E5%A4%96%E9%93%BE%E9%97%AE%E9%A2%98%20%E5%A4%84%E7%90%86/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2022/03/12/Java%E9%A2%84%E7%BC%96%E8%AF%91%E4%B8%80%E4%BA%9B%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%B1%80%E9%99%90.md/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&text=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&is_video=false&description=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Codeql 环境手模手搭建和简单使用&body=Check out this article: https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&name=Codeql 环境手模手搭建和简单使用&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&t=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-前言"><span class="toc-number">1.</span> <span class="toc-text">0x00 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-CodeQL是什么"><span class="toc-number">2.</span> <span class="toc-text">0x01 CodeQL是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-相关下载"><span class="toc-number">3.</span> <span class="toc-text">0x01 相关下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-安装详细步骤"><span class="toc-number">4.</span> <span class="toc-text">0x02 安装详细步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、vscode-环境"><span class="toc-number">4.1.</span> <span class="toc-text">1、vscode 环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-安装-CodeQL-引擎"><span class="toc-number">4.2.</span> <span class="toc-text">2 安装 CodeQL 引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-克隆工作车间-Codeql-starter"><span class="toc-number">4.3.</span> <span class="toc-text">3 克隆工作车间 Codeql starter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-配置环境变量"><span class="toc-number">4.4.</span> <span class="toc-text">4 配置环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-系统环境变量添加"><span class="toc-number">4.5.</span> <span class="toc-text">5 系统环境变量添加</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-创建数据库（Java）"><span class="toc-number">5.</span> <span class="toc-text">0x03 创建数据库（Java）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-导入库进行查询"><span class="toc-number">6.</span> <span class="toc-text">0x04 导入库进行查询</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Codeql 环境手模手搭建和简单使用
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Zeo 安全实验室</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-03-14T04:26:04.000Z" itemprop="datePublished">2022-03-14</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/vscode-web%E5%AE%89%E5%85%A8-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%AE%89%E5%85%A8/" rel="tag">vscode web安全 代码审计 安全</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <a id="more"></a>

<h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>最近这个东西实在太火了，而且log4j 和最近的<a href="https://blog.csdn.net/god_zzZ/article/details/123314194" target="_blank" rel="noopener">Spring Cloud Gateway</a> 都说是利用codeql来挖掘的，好不好用先用了再说。所以学习一下这个东西  
　 </p>
<h2 id="0x01-CodeQL是什么"><a href="#0x01-CodeQL是什么" class="headerlink" title="0x01 CodeQL是什么"></a>0x01 CodeQL是什么</h2><p>　　<br>在我接触这个东西之前，我一直以为这是一个代码审计的工具，类似于Fortify rips 这种东西？<br>　<br>但其实并不是，理解大大错了。。。</p>
<p>还记得记得SQL的全称吗？ -&gt; Structured Query Language:结构化查询语言</p>
<p>所以我简单通俗的理解就是：</p>
<ul>
<li>Codeql = code + ql，这样就是一门面向对象的编程语言（对比SQL）</li>
<li>是把代码结构化分析后的存在一个代码数据库里面</li>
<li>然后就是写ql就可以进行各种查询</li>
<li>找某个方法、类、参数的传递等等。。。</li>
</ul>
<p>神奇。。</p>
<p>官方地址：</p>
<p><a href="https://github.com/github/codeql" target="_blank" rel="noopener">github/codeql: CodeQL: the libraries and queries that power security researchers around the world, as well as code scanning in GitHub Advanced Security (code scanning), LGTM.com, and LGTM Enterprise</a></p>
<p><a href="https://github.com/github/codeql" target="_blank" rel="noopener">https://github.com/github/codeql</a></p>
<h2 id="0x01-相关下载"><a href="#0x01-相关下载" class="headerlink" title="0x01 相关下载"></a>0x01 相关下载</h2><p>CodeQL本身包含两部分解析引擎+SDK</p>
<p>我推荐直接下载这个！可以直接配合 vscode 的现成项目，使用方便。</p>
<p><a href="https://github.com/github/vscode-codeql-starter" target="_blank" rel="noopener">https://github.com/github/vscode-codeql-starter</a></p>
<p>（注意下载的时候不能直接git clon，因为里面包含子项目</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6a3c5018d5d0d0db8e4f98dcdca28a2b.png" alt="image-20220304221924777"></p>
<h2 id="0x02-安装详细步骤"><a href="#0x02-安装详细步骤" class="headerlink" title="0x02 安装详细步骤"></a>0x02 安装详细步骤</h2><p>我这边推荐使用 vscode-codeql-starter 这个现成的项目，使用起来很方便</p>
<h3 id="1、vscode-环境"><a href="#1、vscode-环境" class="headerlink" title="1、vscode 环境"></a>1、vscode 环境</h3><ul>
<li>首先需要在官网下载并安装Visual Studio Code</li>
</ul>
<p><a href="https://code.visualstudio.com/" target="_blank" rel="noopener">Visual Studio Code - Code Editing. Redefined</a></p>
<ul>
<li>安装codeql插件：</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1e197eb521572e3f8c5127107423f3a2.png" alt="image-20220304222734040"></p>
<h3 id="2-安装-CodeQL-引擎"><a href="#2-安装-CodeQL-引擎" class="headerlink" title="2 安装 CodeQL 引擎"></a>2 安装 CodeQL 引擎</h3><p>s引擎二进制文件下载 ：<a href="https://github.com/github/codeql-cli-binaries/releases" target="_blank" rel="noopener">Releases · github/codeql-cli-binaries</a></p>
<p>（推荐直接下载codeql.zip 这个是多平台都打包在一起）</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/a2cb467ec36e31755ce60c6ea7d6bbc8.png" alt="image-20220304221553522"></p>
<h3 id="3-克隆工作车间-Codeql-starter"><a href="#3-克隆工作车间-Codeql-starter" class="headerlink" title="3 克隆工作车间 Codeql starter"></a>3 克隆工作车间 Codeql starter</h3><p>我推荐直接下载这个！可以直接配合 vscode 的现成项目，使用方便。</p>
<p><a href="https://github.com/github/vscode-codeql-starter" target="_blank" rel="noopener">https://github.com/github/vscode-codeql-starter</a></p>
<p>（注意下载的时候不能直接git clone，因为里面包含子项目</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6a3c5018d5d0d0db8e4f98dcdca28a2b.png" alt="image-20220304221924777"></p>
<p>这个项目里的 submodule 也须要 Clone</p>
<p>使用下面命令一步到位</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --recursive https://github.com/github/vscode-codeql-starter/</span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/img_convert/6592caf3f2edce99827af28ea26d87c7.png" alt="image-20220304224556711"><br>(如果子模块clone失败，可以自己下载放进去也行)</p>
<h3 id="4-配置环境变量"><a href="#4-配置环境变量" class="headerlink" title="4 配置环境变量"></a>4 配置环境变量</h3><p>1 、在 VSCode 菜单中点击 <code>File &gt; Open Workspace</code> 选择 <code>vscode-codeql-starter.code-workspace</code> 这个文件来打开这个工作区。</p>
<p>2、找到插件的扩展设置</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/426fefbba4e3f578100b4c814db923e3.png" alt="image-20220304225202804"></p>
<p>3、设置引擎地址</p>
<p>这里面添加引擎刚刚下载的 CodeQL 引擎的可执行文件</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/80218c8e03b9e69baef9e37553bf9faf.png" alt="image-20220304225259649"></p>
<p>就是codeql.zip 解压后对于系统的可执行文件地址<img src="https://img-blog.csdnimg.cn/img_convert/1b663484abb11ad4a00eaf9e60d6cf86.png" alt="image-20220304225430633"></p>
<h3 id="5-系统环境变量添加"><a href="#5-系统环境变量添加" class="headerlink" title="5 系统环境变量添加"></a>5 系统环境变量添加</h3><p>为了方便后面使用codeql，还需要把刚刚那个添加到系统里面</p>
<p>我是Mac 就是这样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim ~&#x2F;.zshrc</span><br><span class="line">alias codeql&#x3D;&quot;&#x2F;Users&#x2F;zy&#x2F;Documents&#x2F;project&#x2F;codeql&#x2F;CodeQLCLI&#x2F;codeql&quot;</span><br></pre></td></tr></table></figure>

<p>windows 就和添加Java环境变量一样，设置一个path到刚刚到codeql.exe 那个目录就行了</p>
<p>到这里环境应该就是好了，下一步就是建立数据库了（或导入数据库）</p>
<h2 id="0x03-创建数据库（Java）"><a href="#0x03-创建数据库（Java）" class="headerlink" title="0x03 创建数据库（Java）"></a>0x03 创建数据库（Java）</h2><ul>
<li>打开终端使用 codeql命令</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create [数据库存的路径]  --language&#x3D;&quot;java&quot;  --command&#x3D;&quot;mvn clean install --file pom.xml&quot; --source-root&#x3D;[源码路径路径]</span><br></pre></td></tr></table></figure>

<p>例如我的用的这个项目作为审计的目标 <a href="https://github.com/godzeo/java-sec-code" target="_blank" rel="noopener">https://github.com/godzeo/java-sec-code</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codeql database create /Users/zy/Documents/project/codeql/vscode-codeql-starter-main/database/codeql_java-sec-code  --language="java"  --command="mvn clean install --file pom.xml" --source-root=/Users/zy/Documents/project/sec_java_vul/java-sec-code</span><br></pre></td></tr></table></figure>

<p>然后把这个命令拆解看一下</p>
<table>
<thead>
<tr>
<th>codeql database create java-database</th>
<th>创建数据库，名字为codeql_java-sec-code</th>
</tr>
</thead>
<tbody><tr>
<td>-language=java</td>
<td>编译语言为java</td>
</tr>
<tr>
<td>-command=“mvn clean install –file pom.xml”</td>
<td>利用命令进行源码编译</td>
</tr>
<tr>
<td>–source-root</td>
<td>设置源码的路径</td>
</tr>
</tbody></table>
<p>成功建库</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/87b24445faaf162524b17454cefb235f.png" alt="image-20220305164718115"></p>
<h2 id="0x04-导入库进行查询"><a href="#0x04-导入库进行查询" class="headerlink" title="0x04 导入库进行查询"></a>0x04 导入库进行查询</h2><p>在vscode里面找到 导入数据库</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0c7a8368eba51c627e4118781cda3bab.png" alt="image-20220305164846289"></p>
<p>这样就是导入成功了</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/738e5fe7a38bfc958543ddbe64af0c88.png" alt="image-20220305164933079"></p>
<p>下面开始查询：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">跟目录&#x2F;ql&#x2F;java&#x2F;ql&#x2F;src&#x2F;Security                 放着一些官方的规则(java)，可直接用。</span><br><span class="line">这跟目录&#x2F;ql&#x2F;java&#x2F;ql&#x2F;src&#x2F;experimental&#x2F;Security  一些还在实验中的规则(java)。</span><br></pre></td></tr></table></figure>

<p>找到规则文件试一下，xss.ql 文件 ，右键 Run Query</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6d797139186e93960c732702e8e527e0.png" alt="image-20220305165221286"></p>
<p>出结果了，跑通了这就是</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b4ac3fe75d4adfda68b9c3ebe8614e7a.png" alt="image-20220305165413207"></p>
<p>然后点一下就找到了漏洞点了。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/23796c41f92e639d123a40bdbfbeaa4f.png" alt="image-20220305165516750"></p>
<p>基础的完成之后，这就能勉勉强强用了，然后就是学习语法规则，自己写规则使用了</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/categories">分类</a></li>
         
          <li><a href="/projects_url">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-前言"><span class="toc-number">1.</span> <span class="toc-text">0x00 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-CodeQL是什么"><span class="toc-number">2.</span> <span class="toc-text">0x01 CodeQL是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-相关下载"><span class="toc-number">3.</span> <span class="toc-text">0x01 相关下载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-安装详细步骤"><span class="toc-number">4.</span> <span class="toc-text">0x02 安装详细步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、vscode-环境"><span class="toc-number">4.1.</span> <span class="toc-text">1、vscode 环境</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-安装-CodeQL-引擎"><span class="toc-number">4.2.</span> <span class="toc-text">2 安装 CodeQL 引擎</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-克隆工作车间-Codeql-starter"><span class="toc-number">4.3.</span> <span class="toc-text">3 克隆工作车间 Codeql starter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-配置环境变量"><span class="toc-number">4.4.</span> <span class="toc-text">4 配置环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-系统环境变量添加"><span class="toc-number">4.5.</span> <span class="toc-text">5 系统环境变量添加</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-创建数据库（Java）"><span class="toc-number">5.</span> <span class="toc-text">0x03 创建数据库（Java）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-导入库进行查询"><span class="toc-number">6.</span> <span class="toc-text">0x04 导入库进行查询</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&text=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&is_video=false&description=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Codeql 环境手模手搭建和简单使用&body=Check out this article: https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&title=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&name=Codeql 环境手模手搭建和简单使用&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://godzeo.github.io/2022/03/14/Codeql%20%E7%8E%AF%E5%A2%83%E6%89%8B%E6%A8%A1%E6%89%8B%E6%90%AD%E5%BB%BA%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/&t=Codeql 环境手模手搭建和简单使用" target="_blank" rel="noopener"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2022
    Zeo
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/categories">分类</a></li>
         
          <li><a href="/projects_url">项目</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


</body>
</html>
